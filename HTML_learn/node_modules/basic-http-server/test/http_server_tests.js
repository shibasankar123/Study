"use strict";
var http = require('http');
var assert = require('assert');
var sinon = require('sinon');
var HttpServer = require('./../server/http_server');
var logger = require('./../server/logger');

describe('http_server', function() {
    beforeEach(function() {
        this.sandbox = sinon.sandbox.create();
        this.httpStub = this.sandbox.stub(http, 'createServer');
    });

    afterEach(function() {
        this.sandbox.restore();
    });

   it('should initialise correctly', function() {
       let sut = new HttpServer();
       assert(sut!== null);
       assert(this.httpStub.calledOnce);
   });

    it.skip('handleRequest returns a 404 if the url is not registered', function() {
        let loggerStub = this.sandbox.stub(logger, 'info');
        let request = {};
        let response = {};

        var sut = new HttpServer();
        sut.registerRoute('/home', 'GET');
        sut._handleRequest(request, response);

        assert(loggerStub.calledOnce);
        assert(request.body === null);
    });
});